<div class="lg:container lg:mx-auto lg:px-16 xl:px-20 2xl:px-24 overflow-hidden">
    <!-- <h1>首頁內容</h1> -->
    <div class="flex justify-between wapper_container_hand">
        <div id="lottie-container-hand" class="self-start flex-1 pt-12"></div>
        <div class="text-5xl xl:text-6xl custom-font-Fahkwang self-end pb-24 lg:pb-36" style="letter-spacing: 0.34em; color: #606060;">
            <h3 class="pb-4"> Hi, there👇</h3>
            <h3> It’s </h3>
        </div>
    </div>
    <div class="flex items-center justify-between h-screen">
        <div id="lottie-container-p" class="w-3/5"></div>
        <div class="inline-flex flex-col items-center px-16 w-2/5" style="letter-spacing: 0.01em; color: #606060;">
            <div id="lottie-container-mika_characters"></div>
            <h3 class="text-xl custom-font-Fahkwang">A UI/UX designer foucused on business probability and create solution in a fun way</h3>
            <div class="self-end me-3">
                <a href="/about" class="move-horizontal flex items-center pt-4">
                    Learn more
                    <img src="src/assets/icons/icon _arrow down circle_.png" class="w-14 lg:w-16 ps-1" alt="Arrow" />
                </a>
            </div>
        </div>
    </div>
    <div id="block-container" class="grid grid-cols-2 gap-10 mt-30 px-4 lg:px:6 xl:px-16 2xl:px-28"></div>
</div>

<script>
    // 方塊數量
    var blockCount = 4;

    // 圖片和連結的陣列
    var blockItems = [
        // 1 ~ 4
        { image: "src/assets/images/example_image_1.png", link: "" },
        { image: "src/assets/images/example_image_2.png", link: "" },
        { image: "src/assets/images/example_image_3.png", link: "" },
        { image: "", link: "" },
        // 5 ~ 8
        { image: "", link: "" },
        { image: "", link: "" },
        { image: "", link: "" },
        { image: "", link: "" },
        // 9 ~ 12
        { image: "", link: "" },
        { image: "", link: "" },
        { image: "", link: "" },
        { image: "", link: "" },
        // 13 ~ 16
        { image: "", link: "" },
        { image: "", link: "" },
        { image: "", link: "" },
        { image: "", link: "" },
    ];

    generateBlocks(blockCount, blockItems);

    function generateBlocks(blockCount, blockItems) {
        var blocksArea = $('#block-container');

        for (var i = 0; i < blockCount; i++) {
            var blockData = blockItems[i];

            var image = blockData.image;
            var link = blockData.link;

            var block = $('<div>').addClass('block aspect-square overflow-hidden opacity-0 transform translate-y-8 transition-all custom-duration-3500 ease-out');
            var content = $('<div>').addClass('content');

            if (image !== "") {
                var img = $('<img>').attr('src', image)
                                    .addClass('w-full h-full object-cover')
                                    .on('error', function() { $(this).hide(); });
                content.append(img);
            }

            if (link !== "") {
                var a = $('<a>').attr('href', link)
                                .addClass('block w-full h-full')
                                .attr('target', '_blank')
                                .attr('rel', 'noreferrer noopener')
                                .append(content);
                block.append(a);
            } else {
                block.append(content);
            }

            blocksArea.append(block);
        }

        window.addEventListener('scroll', function() {
        var blocks = document.querySelectorAll('.block');
        
        blocks.forEach(function(block) {
            var blockPosition = block.getBoundingClientRect().top;
            var windowHeight = window.innerHeight;
            
            // 判斷方塊是否進入視窗範圍
            if (blockPosition < windowHeight) {
            block.classList.add('opacity-100', 'translate-y-0');
            }
        });
        });
    }

    var lottieContainer_hand = document.getElementById("lottie-container-hand");
    lottie.loadAnimation({
        container: lottieContainer_hand,
        renderer: "svg",
        loop: true,
        autoplay: true,
        path: "https://uploads-ssl.webflow.com/637d811b57fdde36a2c0ad03/63872dd803666f1e3415cc91_hand2.json"
    });

    var lottieContainer_p = document.getElementById('lottie-container-p');
    var lottieContainer_mika_characters = document.getElementById('lottie-container-mika_characters');

    var animation_p = lottie.loadAnimation({
        container: lottieContainer_p,
        renderer: 'svg',
        loop: false,
        autoplay: false,
        path: 'https://uploads-ssl.webflow.com/637d811b57fdde36a2c0ad03/63846e13ee7073da028730b6_sit.json'
    });

    var animation_mika_characters = lottie.loadAnimation({
        container: lottieContainer_mika_characters,
        renderer: 'svg',
        loop: false,
        loop: false,
        path: 'src/assets/mika_s.json'
        // path: 'https://uploads-ssl.webflow.com/637d811b57fdde36a2c0ad03/6384684aee7073c54386d6bf_mika2.json'
    });

    // 設置動畫播放進度的函數
    function setAnimationProgress(anim, progress) {
        anim.goToAndStop(anim.getDuration(true) * progress, true);
    }

    // 計算滑動方向和到中點距離的函數
    function calculateScrollValues(anim, containerDiv) {
        var scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        var windowHeight = window.innerHeight;
        var containerOffsetTop = containerDiv.offsetTop;
        var containerHeight = containerDiv.offsetHeight;
        var scrollDistance = scrollTop + windowHeight / 2 - (containerOffsetTop + containerHeight / 2);
        var scrollDirection = scrollDistance > 0 ? 'down' : 'up';
        var scrollProgress = Math.abs(scrollDistance) / (windowHeight / 2);
        console.log(containerOffsetTop, containerOffsetTop, containerHeight, scrollDistance);
        // console.log(scrollDirection, scrollProgress);
        
        // 根據滑動方向和進度控制動畫播放
        if (scrollDirection === 'down') {
            setAnimationProgress(anim, 0.99);
        } else {
            if (scrollProgress >= 1) {
                setAnimationProgress(anim, 0.01);
            } else {
                setAnimationProgress(anim, 1 - scrollProgress);
            }
        }
    }
    
    // 監聽滾動事件
    window.addEventListener('scroll', () => {
        calculateScrollValues(animation_p, lottieContainer_p);
        calculateScrollValues(animation_mika_characters, lottieContainer_mika_characters);
    });

    // 初始狀態下播放動畫
    animation_p.play();
    animation_mika_characters.play();
</script>