<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://uploads-ssl.webflow.com/637d811b57fdde36a2c0ad03/637dc255a321ea6572681d1e_favicon.png" rel="shortcut icon" type="image/x-icon">
  <title>Mika's Portfolio</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.4/lottie.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"  rel="stylesheet" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  
  <link href="src/assets/style/css/style.min.css" rel="stylesheet">
</head>

<body class="disable-scroll">
  <div id="loading">
    <div class="fixed inset-0 flex flex-col justify-center items-center text-2xl font-bold">
      <img class="mb-3" src="src/assets/images/loading.png" alt="ğŸ˜¾" />
      è¼‰å…¥ä¸­......
    </div>  
  </div>

  <div id="header"></div>

  <div id="app"></div>

  <div id="footer"></div>

  <div id="tooSmall"></div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://unpkg.com/page/page.js"></script>

  <script>
    // ç­‰å¾…é é¢å®Œå…¨åŠ è¼‰
    window.addEventListener('load', function() {
      // å»¶é²ä¸€æ®µæ™‚é–“å¾Œé€æ¼¸éš±è— loading ç•«é¢
      setTimeout(function() {
        document.querySelector('body').classList.remove('disable-scroll');
        document.querySelector('#loading').style.opacity = '0';
      }, 2000);
      
      // åœ¨æ¼¸æ¼¸éš±è—çµæŸå¾Œï¼Œéš±è— loading ç•«é¢
      setTimeout(function() {
        document.querySelector('#loading').style.display = 'none';
      }, 3000);
    });

    $.ajax({
      url: 'src/components/header/header.html',
      dataType: 'html',
      success: function(response) {
        $('#header').html(response);
      }
    });

    $.ajax({
      url: 'src/components/footer/footer.html',
      dataType: 'html',
      success: function(response) {
        $('#footer').html(response);
      }
    });

    $.ajax({
      url: 'src/components/tooSmall.html',
      dataType: 'html',
      success: function(response) {
        $('#tooSmall').html(response);
      }
    });
    
    var routes = {
      '/': {
        page: 'index.html',
        title: "Mika's Portfolio"
      },
      '/about': {
        page: 'about.html',
        title: 'About | Mika\'s Portfolio'
      },
      '/contact': {
        page: 'contact.html',
        title: 'Contact | Mika\'s Portfolio'
      }
    };

    var firstLoad = true;
    var baseUrl = '';

    // // åˆ¤æ–·æ˜¯å¦åœ¨æœ¬åœ°é–‹ç™¼ç’°å¢ƒ
    // if (window.location.hostname === '127.0.0.1' || window.location.hostname === 'localhost') {
    //   // æœ¬åœ°é–‹ç™¼ç’°å¢ƒä¸‹çš„è·¯å¾‘è¨­ç½®
    //   baseUrl = '';
    // } else {
    //   // éƒ¨ç½²åˆ° GitHub Pages ä¸Šçš„è·¯å¾‘è¨­ç½®
    //   baseUrl = '/Mika_Portfolio';
    // }
    page.base(baseUrl);
    
    // è¨­å®šè·¯ç”±
    page('/', function() {
      loadPage(routes['/'].page, routes['/'].title, '/');
    });
    page('/about', function() {
      loadPage(routes['/about'].page, routes['/about'].title, '/about');
    });
    page('/contact', function() {
      loadPage(routes['/contact'].page, routes['/contact'].title, '/contact');
    });
    page('/kinghoksu', function() {
      window.location.href = `${baseUrl}/kinghoksu/index.html`;
    });
    // page('/kinghoksu/page1', function() {
    //   window.location.href = '/kinghoksu/page1.html';
    // });
    page('*', notFoundPage);

    // ç›£è½è·¯ç”±è®ŠåŒ–
    page();

    function loadPage(page, title, url) {
      page = `src/pages/${page.replace('.html', '')}/${page}`;
      // console.log(page);
      $.ajax({
        url: page,
        dataType: 'html',
        success: function(response) {
          $('#app').html(response);

          if (!firstLoad) {
            // å–å¾—å‰ä¸€å€‹é é¢çš„ CSS å’Œ JS æ–‡ä»¶
            var prevCss = $('head link[rel="stylesheet"]:last').attr('href');
            // var prevScript = $('body script:last').attr('src');

            // åˆ é™¤å‰ä¸€å€‹é é¢çš„ CSS å’Œ JS æ–‡ä»¶
            $('head link[rel="stylesheet"][href="' + prevCss + '"]').remove();
            // $('body script[src="' + prevScript + '"]').remove();
          } else {
            firstLoad = false;
          }

          loadCss(page.replace('.html', '.css'));
          // loadScript(page.replace('.html', '.js'));
      
          window.scrollTo({ top: 0, behavior: 'smooth' });
          document.title = title;
        }
      });
    }

    // åŠ è¼‰é é¢çš„ Css æª”æ¡ˆ
    function loadCss(cssFile) {
      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = cssFile;
      document.head.appendChild(link);
    }

    // åŠ è¼‰é é¢çš„ JavaScript æª”æ¡ˆ
    // function loadScript(scriptFile) {
    //   var script = document.createElement('script');
    //   script.src = scriptFile;
    //   document.body.appendChild(script);
    // }

    // é é¢ä¸å­˜åœ¨çš„è™•ç†
    function notFoundPage() {
      loadPage('not-found.html', 'Not Found | Mika\'s Portfolio', '/not-found');
      // document.getElementById('app').innerHTML = '<h1>é é¢æœªæ‰¾åˆ°</h1>';
    }

    // å•Ÿå‹•è·¯ç”±ç›£è½
    page({ hashbang: true });
  </script>
</body>

</html>
